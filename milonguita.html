<head>
  <title>Te Vas de Milonga</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta charset="utf-8">
  <script src="http://ajax.aspnetcdn.com/ajax/jquery.validate/1.14.0/additional-methods.min.js"></script>
</head>

<body>
	<header id="header" class="navbar-fixed-top">
		<div class="container">
			<div class="row">
				<div class="col-md-9 text-left"><h1 id="brand">Te vas de milonga</h1></div>
				{{#if currentUser}}
					<div class="col-md-3 text-center login">
						<p>
							{{currentUser.services.facebook.name}}
							<button id="logout" class="fb-login btn btn-default">Salir</button>
						</p>
					</div>
				{{/if}}
			</div>
			<div class="row controls {{#if hideCalendar}}hide{{/if}}">
				<div class="col-md-12 text-right">

						{{#unless currentUser}}
							<button id="facebook-login" class="fb-login btn btn-default">Ingresar con Facebook</button>
						{{/unless}}						

						{{#if currentUser}}		
							{{#unless showPubForm }}
								<button class="show-pub-form btn btn-default">
									<span class="glyphicon glyphicon-plus" aria-hidden="true"></span> Agregar una publicacion
								</button>
							{{/unless}}
						{{/if}}


						<button class="show-about btn btn-default">Sobre TVM</button>

					{{#if existsPreviousWeek}}

							<button class="previous-week btn btn-default"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span> Semana anterior</button>

					{{/if}}
					{{#if existsNextWeek}}

							<button class="next-week btn btn-default">Semana siguiente <span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></button>

					{{/if}}
				</div>
			</div>
		</div>
	</header>
	<div class="container">
		<div class="row">
			<div class="col-md-12">
				{{#if currentUser}}
			
					{{> addPublication}}

					{{#if showEditPubForm}}
						{{> editPublication}}
					{{/if}}
				
				{{/if}}
			</div>
		</div>
		
		{{#if showPubInfo}}
			<div class="row info">
				{{> infoPublication}}
			</div>
		{{/if}}

		{{#if showAbout}}
			<div class="row about">
				{{> aboutSection}}
			</div>
		{{/if}}

	</div>
	
	<div class="row calendar {{#if hideCalendar}}hide{{/if}}">
		<div class="col-md-12 text-left">
			{{> daysOfWeek}}
		</div>
	</div>

	<div class="container">
		
		{{#if isAdmin}}
		<div class="row">
			<div class="col-md-12 text-left">
				<button class="delete-old-pubs btn btn-default">Delete old publications</button>
			</div>
		</div>
		{{/if}}
	</div>
	<footer id="footer">
		<div class="container">
			<div class="row">
				<div class="col-md-12 text-center">
					<p><b>&lt;/&gt;</b> con <span class="glyphicon glyphicon-heart" aria-hidden="true"></span> por un milonguero uruguayo. 2016.</p>
				</div>
			</div>
		</div>
	</footer>
</body>

<template name="publication">
	<div class="col-md-3">
		<div class="col-md-12 box">
		<div class="col-md-12 text-center" style="margin-bottom:5px;">
			<h4>{{name}}</h4>
		</div>
		<div class="col-md-10 col-md-offset-1">
			<img src="{{c.url picPublicId height=150 width=150 crop='fill'}}" class="img-responsive img-circle"/>			
		</div>
		<div class="col-md-12 text-left">
			<p><span class="glyphicon glyphicon-bullhorn" aria-hidden="true"></span> <span class="text-capitalize">{{type}}</span></p>
			<p><span class="glyphicon glyphicon-time" aria-hidden="true"></span> Comienza: {{time}}</p>
			<p><span class="glyphicon glyphicon-arrow-up" aria-hidden="true"></span> Recomendada: {{upvoteCount}} {{#if pluralUpvoteCount}}veces{{else}}vez{{/if}}</p>
		</div>
		<div class="col-md-12 text-center" style="margin-top:5px;">
			<p>
				{{#if currentUser}}
					{{#if canUpvote}}
						<button class="btn btn-default upvote"> <span class="glyphicon glyphicon-arrow-up" aria-hidden="true"></span> Recomendar</button>
					{{else}}
						<button class="btn btn-default cancel-upvote"><span class="glyphicon glyphicon-ok" aria-hidden="true"> Recomendada</span></button>
					{{/if}}
				{{/if}}
				<button class="pub-info btn btn-default">Ver mas</button>
			</p>
			{{#if isOwnerOrAdmin }}
				<button class="btn btn-default delete"><span class="glyphicon glyphicon-remove" aria-hidden="true"></span> Eliminar</button>
				<button class="btn btn-default show-edit-pub-form"><span class="glyphicon glyphicon-pencil" aria-hidden="true"></span> Editar</button>
    		{{/if}}
		</div>
		</div>
	</div>
	
</template>

<template name="infoPublication">
	<div class="col-md-12 info-margin">	
		<div class="col-md-12">		
			<div class="col-md-4">
				<img src="{{c.url pubInfo.picPublicId}}" class="img-responsive" />
			</div>
			<div class="col-md-8">
				<div class="col-md-12">
					<div class="col-md-10">
						<h2 style="margin-top:0;">{{pubInfo.name}}</h2>
					</div>
					<div class="col-md-2">
						<button class="close-info-pub btn btn-default pull-right">Cerrar</button>
					</div>
				</div>
				<div class="col-md-12" style="margin-top:10px;">
					<p><span class="glyphicon glyphicon-bullhorn" aria-hidden="true"></span> 
						Tipo de publicacion: {{pubInfo.type}}</p>
					<p><span class="glyphicon glyphicon-user" aria-hidden="true"></span> 
						Publicacion creada por {{pubInfo.username}}</p>
					<p><span class="glyphicon glyphicon-map-marker" aria-hidden="true"></span> 
						Direccion: {{pubInfo.address}}</p>
					<p><span class="glyphicon glyphicon-calendar" aria-hidden="true"></span> 
						Fecha: {{pubInfo.date}}</p>
					<p><span class="glyphicon glyphicon-usd" aria-hidden="true"></span> 
						Costo: {{pubInfo.cost}}</p>
					<p><span class="glyphicon glyphicon-time" aria-hidden="true"></span> 
						Hora: {{pubInfo.time}}</p>
					<p><span class="glyphicon glyphicon-thumbs-up" aria-hidden="true"></span> 
						Facebook: {{pubInfo.fbLink}}</p>
					<p><span class="glyphicon glyphicon-arrow-up" aria-hidden="true"></span> 
						Recomendado por {{pubInfo.upvoteCount}} usuarios de milonguita</p>
				</div>
			</div>
			<div class="col-md-12 text-center" style="margin-top:10px;">
				<div class="col-md-8 col-md-offset-2">
					<div class="col-md-12">
						{{#unless isEmptyFBFriendsUpvoted}}
							<p>{{numFBFriendsUpvoted}} de tus amigos recomiendan esta publicacion.</p>
						{{/unless}}
						{{#each getFBFriendsUpvoted}}
								<img src="{{url}}" title="{{name}}"/>
						{{/each}}
					</div>
				</div>
				<div class="col-md-8 col-md-offset-2">
					<h4>Descripcion: </h4>
					<div class="col-md-12 text-left">
						<p>{{pubInfo.description}}</p>
					</div>
				</div>
			</div>
			<div class="col-md-12">
				<div class="col-md-2 col-md-offset-10">
					<button class="close-info-pub btn btn-default pull-right">Cerrar</button>
				</div>
			</div>
		</div>
	</div>
</template>

<template name="addPublication">
	<div class="col-md-12 add {{#unless showPubForm }}hide{{/unless}}">
		<div class="col-md-10 text-center"><h2>Agregar una nueva publicacion</h2></div>
		<div class="col-md-2" style="margin-top:25px;">
			<button class="close-addPub btn btn-default">Cerrar</button>
		</div>
		<div class="col-md-12">
			<form class="new-publication form-horizontal">
				<div class="col-md-6">
				<div class="col-md-12">
				<div class="form-group">
					<label for="addPubName" class="col-sm-2 control-label">Nombre:</label>
					<div class="col-sm-10">
						<input id="addPubName" type="text" name="name" class="required form-control" />
						<span class="help-block">A block of help text that breaks onto a new line and may extend beyond one line.</span>
					</div>
				</div>
				<div class="form-group">
					<label for="addPubType" class="col-sm-2 control-label">Tipo de publicacion:</label>				
					<div class="col-sm-10">
						<select id="addPubType" name="type" class="required form-control">
						  <option value="milonga" {{isTypeMilonga editInfo.type}} >Milonga</option> 
						  <option value="event"  {{isTypeEvent editInfo.type}} >Evento</option>
						  <option value="practica" {{isTypePractica editInfo.type}} >Practica</option>
						</select>
					</div>
				</div>	
				<div class="form-group">
					<label for="addPubAddress" class="col-sm-2 control-label">Direccion:</label>
					<div class="col-sm-10">				
						<input id="addPubAddress" type="text" name="address" class="required form-control" />
					</div>
				</div>
				<div class="form-group">
					<label for="addPubCost" class="col-sm-2 control-label">Costo:</label>
					<div class="col-sm-10">				
						<input id="addPubCost" type="text" name="cost" class="required form-control" />
					</div>
				</div>
				<div class="form-group">
					<label for="addPubTime" class="col-sm-2 control-label">Hora:</label>
					<div class="col-sm-10">				
						<input id="addPubTime" type="text" name="time" class="required form-control" />
					</div>
				</div>
				<div class="form-group">
					<label for="addPubFBLink" class="col-sm-2 control-label">Facebook link:</label>
					<div class="col-sm-10">				
						<input id="addPubFBLink" type="text" name="fbLink" class="required url form-control" />
					</div>
				</div>
				<div class="form-group">
					<label for="photo_add" class="col-sm-2 control-label">Subir imagen:</label>					
					<div class="col-sm-10">
						<input type="file" id="photo_add" name="photo_add" class="form-control" accept="image/*"/>
					</div>
				</div>
				</div>
				</div>
				<div class="col-md-6">
				<div class="col-md-12">
				<div class="form-group">
					<label for="add-datepicker" class="col-sm-2 control-label">Fecha:</label>
					<div class="col-sm-6 col-sm-offset-2">				
						<input id="add-datepicker" name="date" class="required date form-control" type="hidden" />
					</div>
				</div>														
				<div class="form-group">
					<label for="addPubDesc" class="col-sm-12 text-left">Descripcion: </label>
					<div class="col-sm-12">
						<span class="help-block">A block of help text that breaks onto a new line and may extend beyond one line</span>				
						<textarea id="addPubDesc" name="description" class="required form-control" rows="7" ></textarea>
					</div>
				</div>
				<div class="form-group">
					<div class="col-sm-offset-2 col-sm-10">
						<div class="checkbox">
							<label>
								<input type="checkbox" name="keepPublication" /> Mantener publicacion.
							</label>
						</div>
					</div>
				</div>
				</div>
				</div>
				<div class="form-group">
					<div class="col-sm-12 text-center">				
						<input type="submit" class="btn btn-default" value="Agregar Publicacion" />
					</div>
				</div>
			</form>
		</div>
	</div>

</template>

<template name="editPublication">
	<div class="col-md-12 edit {{#unless showEditPubForm }}hide{{/unless}}">
		<div class="col-md-12">
			<div class="col-md-10 text-center"><h2>Editar una publicacion</h2></div>
			<div class="col-md-2" style="margin-top:25px;">
				<button class="close-editPub btn btn-default">Cerrar</button>
			</div>
		</div>
		<div class="col-md-12">
			<form class="edit-publication form-horizontal">
				<div class="col-md-6">
					<div class="col-md-12">
						<div class="form-group">				
							<input type="hidden" name="id"  class="required" value="{{editInfo._id}}" />
						</div>							
						<div class="form-group">
							<label for="editPubName" class="col-sm-2 control-label">Nombre:</label>							
							<div class="col-sm-10">				
								<input id="editPubName" type="text" name="name" class="required form-control" value="{{editInfo.name}}" />
							</div>
						</div>
						<div class="form-group">
							<label for="editPubType" class="col-sm-2 control-label">Tipo de publicacion:</label>							
							<div class="col-sm-10">				
								<select id="editPubType" name="type" class="required form-control">
								  <option value="milonga" {{isTypeMilonga editInfo.type}} >Milonga</option> 
								  <option value="event"  {{isTypeEvent editInfo.type}} >Evento</option>
								  <option value="practica" {{isTypePractica editInfo.type}} >Practica</option>
								</select>
							</div>
						</div>
						<div class="form-group">
							<label for="editPubAddress" class="col-sm-2 control-label">Direccion:</label>
							<div class="col-sm-10">				
								<input id="editPubAddress" type="text" name="address" class="required form-control" value="{{editInfo.address}}" />
							</div>
						</div>
						<div class="form-group">
							<label for="editPubCost" class="col-sm-2 control-label">Costo:</label>
							<div class="col-sm-10">				
								<input id="editPubCost" type="text" name="cost" class="required form-control" value="{{editInfo.cost}}" />
							</div>
						</div>
						<div class="form-group">
							<label for="editPubTime" class="col-sm-2 control-label">Hora:</label>							
							<div class="col-sm-10">				
								<input id="editPubTime" type="text" name="time" class="required form-control" value="{{editInfo.time}}" />
							</div>
						</div>
						<div class="form-group">
							<label for="editPubFBLink" class="col-sm-2 control-label">Facebook link:</label>
							<div class="col-sm-10">
								<input id="editPubFBLink" type="text" name="fbLink" class="required url form-control" value="{{editInfo.fbLink}}" />
							</div>
						</div>
						<div class="form-group">
							<label for="photo_edit" class="col-sm-2 control-label">Subir imagen:</label>
							<div class="col-sm-10">
								<input type="file" id="photo_edit" name="photo" class="form-control" accept="image/*"/>
							</div>
						</div>
					</div>
				</div>
				<div class="col-md-6">
					<div class="col-md-12">						
						<div class="form-group">
							<label for="edit-datepicker" class="col-sm-2 control-label">Fecha:</label>
							<div class="col-sm-6 col-sm-offset-2">				
								<input id="edit-datepicker" name="date" class="required date form-control" type="hidden" />
							</div>
						</div>																
						<div class="form-group">
							<label for="editPubDesc" class="col-sm-12 text-left">Descripcion: </label>
							<div class="col-sm-12">				
								<textarea id="editPubDesc" name="description" class="required form-control" rows="7" value="{{editInfo.description}}" ></textarea>
							</div>
						</div>
					</div>
				</div>
				<div class="form-group">
					<div class="col-sm-12 text-center">			
						<input type="submit" class="btn btn-default" value="Edit Publication" />
					</div>
				</div>
			</form>
		</div>
	</div>
</template>

<template name="aboutSection">
	<div class="col-md-12">
		<div class="col-md-10">
			<h1>Sobre tvm!</h1>
		</div>
		<div class="col-md-2">
			<button class="close-about btn btn-default">Cerrar</button>
		</div>
	</div>
	<div class="col-md-12">
		<p>Bacon ipsum dolor amet shank boudin tri-tip pork loin, shankle porchetta ribeye prosciutto pork belly ball tip. Ball tip pork loin strip steak porchetta corned beef ham hock shank fatback kielbasa meatball prosciutto pork chop short ribs. Pork alcatra short ribs, spare ribs pig hamburger shank kevin. Fatback ham hock leberkas ribeye, pork belly jerky hamburger shoulder prosciutto turkey. Corned beef alcatra bresaola turkey sirloin meatball cow leberkas. Ham hock brisket chuck frankfurter meatball venison tail capicola spare ribs pork loin short loin. Flank pancetta chuck fatback beef, cow biltong turducken andouille t-bone meatloaf sausage pork belly tail.</p>

<p>Short loin prosciutto ribeye biltong, porchetta flank picanha pork loin t-bone filet mignon pig ham salami beef tongue. Bacon ribeye cupim, spare ribs pork chop ground round brisket porchetta. Porchetta alcatra ground round t-bone pork belly. Pork meatball prosciutto meatloaf. Ball tip beef venison, beef ribs short ribs chuck spare ribs salami pig pork belly.</p>

<p>Pig cow sausage, pork andouille sirloin spare ribs t-bone pork chop bacon turducken flank. T-bone hamburger pancetta jerky, sausage ham prosciutto meatloaf biltong alcatra. Cupim tongue meatloaf, alcatra leberkas biltong landjaeger strip steak ground round prosciutto short loin pork shoulder andouille rump. Sirloin prosciutto spare ribs turkey, boudin filet mignon jerky porchetta strip steak. Doner capicola short loin pig tongue jowl. Tri-tip shankle chuck turkey tail.</p>
	</div>
</template>

<template name="daysOfWeek">
	
	<div class="row">
		<div class="container">
			<div class="row">
				<div class="col-md-12 day-grid">
					<div class="col-md-3">
						<div class="col-md-10 col-md-offset-1 box">
						<h3>{{nameOfDay 0}}</h3>
						<h1 class="text-center">{{numberOfDate 0}}</h1>
						<h3 class="text-right">{{nameOfMonth 0}}</h3>
						</div>
					</div>	
					{{# each day 0}}
						{{> publication}}
					{{/each}}
				</div>
			</div>
		</div>
	</div>

	<div class="row odd-row">
		<div class="container">
			<div class="row">
				<div class="col-md-12 day-grid">
					<div class="col-md-3">
						<div class="col-md-10 col-md-offset-1 box">
							<h3>{{nameOfDay 1}}</h3>
							<h1 class="text-center">{{numberOfDate 1}}</h1>
							<h3 class="text-right">{{nameOfMonth 1}}</h3>
						</div>
					</div>	
					{{# each day 1}}
						{{> publication}}
					{{/each}}
				</div>
			</div>
		</div>
	</div>

	<div class="row">
		<div class="container">
			<div class="row">
				<div class="col-md-12 day-grid">
					<div class="col-md-3">
						<div class="col-md-10 col-md-offset-1 box">
							<h3>{{nameOfDay 2}}</h3>
							<h1 class="text-center">{{numberOfDate 2}}</h1>
							<h3 class="text-right">{{nameOfMonth 2}}</h3>
						</div>
					</div>
					{{#each day 2}}
						{{> publication}}
					{{/each}}
				</div>
			</div>
		</div>
	</div>

	<div class="row odd-row">
		<div class="container">
			<div class="row">
				<div class="col-md-12 day-grid">
					<div class="col-md-3">
						<div class="col-md-10 col-md-offset-1 box">
							<h3>{{nameOfDay 3}}</h3>
							<h1 class="text-center">{{numberOfDate 3}}</h1>
							<h3 class="text-right">{{nameOfMonth 3}}</h3>
						</div>
					</div>
					{{#each day 3}}
						{{> publication}}
					{{/each}}
				</div>
			</div>
		</div>
	</div>

	<div class="row">
		<div class="container">
			<div class="row">
				<div class="col-md-12 day-grid">
					<div class="col-md-3">
						<div class="col-md-10 col-md-offset-1 box">
							<h3>{{nameOfDay 4}}</h3>
							<h1 class="text-center">{{numberOfDate 4}}</h1>
							<h3 class="text-right">{{nameOfMonth 4}}</h3>
						</div>
					</div>
				{{#each day 4}}
					{{> publication}}
				{{/each}}
				</div>
			</div>
		</div>
	</div>

	<div class="row odd-row">
		<div class="container">
			<div class="row">
				<div class="col-md-12 day-grid">
					<div class="col-md-3">
						<div class="col-md-10 col-md-offset-1 box">
							<h3>{{nameOfDay 5}}</h3>
							<h1 class="text-center">{{numberOfDate 5}}</h1>
							<h3 class="text-right">{{nameOfMonth 5}}</h3>
						</div>
					</div>
				{{#each day 5}}
					{{> publication}}
				{{/each}}
				</div>
			</div>
		</div>
	</div>

	<div class="row">
		<div class="container">
			<div class="row">
				<div class="col-md-12 day-grid">
					<div class="col-md-3">
						<div class="col-md-10 col-md-offset-1 box">
							<h3>{{nameOfDay 6}}</h3>
							<h1 class="text-center">{{numberOfDate 6}}</h1>
							<h3 class="text-right">{{nameOfMonth 6}}</h3>
						</div>
					</div>
				{{#each day 6}}
					{{> publication}}
				{{/each}}
				</div>
			</div>
		</div>
	</div>
</template>
