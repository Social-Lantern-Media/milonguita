<head>
  <title>milonguita</title>
</head>

<body>
	<div class="container">
		<div class="row">
			<div class="col-md-12 text-center">
			  <h1>Welcome to Milonguita!</h1>

				{{> loginButtons}}

				<div class="col-md-12 text-right">
					{{#if existsPreviousWeek}}
					   <button class="previous-week">Previous Week</button>
					{{/if}}
					{{#if existsNextWeek}}
					   <button class="next-week">Next Week</button>
					{{/if}}
				</div>

				{{#if currentUser}}

					{{> addPublication}}

					{{#if showEditPubForm}}
						{{> editPublication}}
					{{/if}}
				
				{{/if}}
			</div>
		</div>
		
		{{#if showPubInfo}}
			{{> infoPublication}}		
		{{/if}}
	
		<div class="row">
			<div class="col-md-12 text-center">
				{{> daysOfWeek}}
			</div>
		</div>
	</div>
</body>

<template name="publication">
	<li>
	{{#if isOwnerOrAdmin }}
      <button class="delete">&times;</button>
		<button class="show-edit-pub-form">Edit</button>
    {{/if}}
 
    <span><strong>{{username}}</strong> - <a class="pub-info" href="#">{{name}}</a></span>
  </li>
</template>

<template name="infoPublication">
	<div class="col-md-12">	
		<p>Name: {{pubInfo.name}}</p>
		<p>Type: {{pubInfo.type}}</p>
		<p>Description: {{pubInfo.description}}</p>
		<p>Address: {{pubInfo.address}}</p>
		<p>Date: {{pubInfo.date}}</p>
		<p>Cost: {{pubInfo.cost}}</p>
		<p>Time: {{pubInfo.time}}</p>
		<p>Facebook: {{pubInfo.fbLink}}</p>
		<div class="col-md-4 col-md-offset-4">
			<img src="{{c.url pubInfo.picPublicId}}" class="img-responsive" />
		</div>
		<button class="close-info-pub">Close</button>
	</div>
</template>

<template name="addPublication">
	<div class="col-md-12">
		{{#if showPubForm }}
		   <button class="show-pub-form">Close</button>	
		{{else}}
		   <button class="show-pub-form">Add a new Publication</button>
		{{/if}}
	</div>

	<div class="col-md-8 col-md-offset-2 {{#unless showPubForm }}hide{{/unless}}">
		<form class="new-publication">
			<div class="col-md-12">				
				<input type="text" name="name" class="required" placeholder="name" />
			</div>
			<div class="col-md-12">				
				<select name="type" class="required">
				  <option value="milonga" {{isTypeMilonga editInfo.type}} >Milonga</option> 
				  <option value="event"  {{isTypeEvent editInfo.type}} >Evento</option>
				  <option value="practica" {{isTypePractica editInfo.type}} >Practica</option>
				</select>
			</div>										
			<div class="col-md-12">				
				<textarea name="description" class="required" rows="3" placeholder="descripcion" ></textarea>
			</div>	
			<div class="col-md-12">				
				<input type="text" name="address" class="required" placeholder="address" />
			</div>
			<div class="col-md-4 col-md-offset-4">				
					<input id="add-datepicker" name="date" class="required date" type="hidden" />
			</div>
			<div class="col-md-12">				
				<input type="text" name="cost" class="required" placeholder="cost" />
			</div>
			<div class="col-md-12">				
				<input type="text" name="time" class="required" placeholder="time" />
			</div>
			<div class="col-md-12">				
				<input type="text" name="fbLink" class="required url" placeholder="fb link" />
			</div>
			<div class="col-md-12">
				<input type="checkbox" name="keepPublication"/> Keep Publication.
			</div>
			<div class="col-md-12 text-center">
				<input type="file" name="foto"/>
			</div>
			<div class="col-md-12">				
				<input type="submit" value="Add Publication" />
			</div>
		</form>
	</div>

</template>

<template name="editPublication">
	<div class="col-md-8 col-md-offset-2 {{#unless showEditPubForm }}hide{{/unless}}">
		<form class="edit-publication">
				<div class="col-md-12">				
					<input type="hidden" name="id"  class="required" value="{{editInfo._id}}" />
				</div>							
				<div class="col-md-12">				
					<input type="text" name="name" class="required" value="{{editInfo.name}}" />
				</div>
				<div class="col-md-12">				
					<select name="type" class="required">
					  <option value="milonga" {{isTypeMilonga editInfo.type}} >Milonga</option> 
					  <option value="event"  {{isTypeEvent editInfo.type}} >Evento</option>
					  <option value="practica" {{isTypePractica editInfo.type}} >Practica</option>
					</select>
				</div>										
				<div class="col-md-12">				
					<textarea name="description" class="required" rows="3" value="{{editInfo.description}}" ></textarea>
				</div>	
				<div class="col-md-12">				
					<input type="text" name="address" class="required" value="{{editInfo.address}}" />
				</div>
				<div class="col-md-4 col-md-offset-4">				
					<input id="edit-datepicker" name="date" class="required date" type="hidden" />
				</div>
				<div class="col-md-12">				
					<input type="text" name="cost" class="required" value="{{editInfo.cost}}" />
				</div>
				<div class="col-md-12">				
					<input type="text" name="time" class="required" value="{{editInfo.time}}" />
				</div>
				<div class="col-md-12">				
					<input type="text" name="fbLink" class="required url" value="{{editInfo.fbLink}}" />
				</div>
				<div class="col-md-12">				
					<input type="submit" value="Edit Publication" />
				</div>
			</form>
	</div>
</template>

<template name="daysOfWeek">
	<h4>{{nameOfDay 0}} ({{numberOfDate 0}})</h4>
	{{# each day 0}}
		{{> publication}}
	{{/each}}

	<h4>{{nameOfDay 1}} ({{numberOfDate 1}})</h4>
	{{# each day 1}}
		{{> publication}}
	{{/each}}

	<h4>{{nameOfDay 2}} ({{numberOfDate 2}})</h4>
	{{#each day 2}}
		{{> publication}}
	{{/each}}

	<h4>{{nameOfDay 3}} ({{numberOfDate 3}})</h4>
	{{#each day 3}}
		{{> publication}}
	{{/each}}

	<h4>{{nameOfDay 4}} ({{numberOfDate 4}})</h4>
	{{#each day 4}}
		{{> publication}}
	{{/each}}

	<h4>{{nameOfDay 5}} ({{numberOfDate 5}})</h4>
	{{#each day 5}}
		{{> publication}}
	{{/each}}

	<h4>{{nameOfDay 6}} ({{numberOfDate 6}})</h4>
	{{#each day 6}}
		{{> publication}}
	{{/each}}
</template>
